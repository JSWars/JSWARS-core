<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title></title>

    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="./kinetic-v5.1.0.js"></script>
    <script>
        var stage;
        $(document).ready(function(){

            var colMap=[];
            var width=25,height=25;

            for(var i=0;i<width;i+=1){
                colMap[i]=[];
                for(var j=0;j<height;j+=1){
                    if(i===0||i===width-1||j===0||j===height-1)
                    {
                        colMap[i][j]=1;
                    }else{
                        colMap[i][j]=0;
                    }

                }
            }

            stage = new Kinetic.Stage({
                container: 'container',
                width: 1000,
                height: 900
            });
            var layer = new Kinetic.Layer();

            drawMap(layer,colMap);


            stage.add(layer);

            var players={x:5,y:5};

            var playerLayer=new Kinetic.Layer();

            drawPlayers(playerLayer,players);
            stage.add(playerLayer);



        });

        function drawPlayers(layer,players){
            var blockSize = 70/5;
            var randomColor = get_random_color();
            var group = new Kinetic.Group({
                id:new Date().getTime(),
                x:10+blockSize/2,
                y:10+blockSize/2
            });

            var circle=new Kinetic.Arc({
                    x:players.x*blockSize,
                    y:players.y*blockSize,
                    outerRadius: blockSize/2,
                    fill: randomColor,
                    angle: 360}
            );

            group.add(circle);
            layer.add(group);


        }

        function drawMap(layer,map){

            var blockSize = 70/5;
            var counterY = 0;
            var counterX = 0;
            var randomColor = get_random_color();


            var group = new Kinetic.Group({
                id:new Date().getTime(),
                x:10,
                y:10
            });

            for(var i=0;i<25;i++) {
                for (var j = 0; j < 25; j++) {
                    var mapItem = map[i][j];


                    if ((mapItem % 2) !== 0) {
                        var rect = new Kinetic.Rect({
                            x: counterX * blockSize,
                            y: counterY * blockSize,
                            width: blockSize,
                            height: blockSize,
                            fill: randomColor,
                            stroke: '#000000',
                            strokeWidth: 2
                        });
                    }
                    else {
                        var rect = new Kinetic.Rect({
                            x: counterX * blockSize,
                            y: counterY * blockSize,
                            width: blockSize,
                            height: blockSize,
                            fill: 'green',
                            opacity: 0
                        });
                    }

                    group.add(rect);
                    counterX += 1;
                }
                counterY += 1;
                counterX = 0;
            }
            layer.add(group);
            layer.draw();

        }

        function createEnemy(layer,map,x){

            var y = 0;
            if( x >= 10){
                y = 80;
                x = x - 10;
            }

            var group = new Kinetic.Group({
                id:new Date().getTime(),
                x:(x*70)+10*x,
                y:y
            });
            console.log((x*70)+10*x);
            var blockSize = 70/5;
            var counterY = 0;
            var counterX = 0;
            var randomColor = get_random_color();
            for(var i=0;i<map.length;i++){
                var mapItem = map[i];


                if( (i % 5) === 0 && (i !== 0) ){
                    counterY += 1;
                    counterX = 0;
                }

                if( (mapItem % 2) === 0){
                    var rect = new Kinetic.Rect({
                        x: counterX*blockSize,
                        y: counterY*blockSize,
                        width: blockSize,
                        height: blockSize,
                        fill: randomColor,
                        stroke:'#000000',
                        strokeWidth:2
                    });
                }
                else{
                    var rect = new Kinetic.Rect({
                        x: counterX*blockSize,
                        y: counterY*blockSize,
                        width: blockSize,
                        height: blockSize,
                        fill: 'green',
                        opacity:0
                    });
                }

                group.add(rect);
                counterX += 1;
            }

            layer.add(group);
            layer.draw();
        }


        function get_random_color() {
            var letters = '0123456789ABCDEF'.split('');
            var color = '#';
            for (var i = 0; i < 6; i++ ) {
                color += letters[Math.round(Math.random() * 15)];
            }
            return color;
        }
    </script>
    <style>
        body{
            background-image:url('http://i221.photobucket.com/albums/dd22/djmid71/background2_zpsa8689ce2.jpg');
            background-color:black;
        }
    </style>
</head>
<body>
<div id="container"></div>
</body>
</html>